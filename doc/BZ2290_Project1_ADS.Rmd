---
title: "R Notebook For Applied Data Science-Project I"
output:
  html_document: default
  html_notebook: default
---
```{r, message=FALSE, warning=FALSE, include=FALSE}
#NECESSARY PACKAGES

#Please make sure all package referred in this file are properly loaded
###################################################################
source("D:/Columbia University/Spring2017-Applied Data Science/Project_1_Bz2290/Spr2017-Proj1-bz2290/doc/Package.R")
###################################################################

#Functions needed
###################################################################
source("D:/Columbia University/Spring2017-Applied Data Science/Project_1_Bz2290/Spr2017-Proj1-bz2290/lib/Functions.R")
###################################################################
```

```{r, include=FALSE}
##PREPRCESSIONING OF THE DATA##

#Please also modify the path within Preprocess.R
###################################################################
source("D:/Columbia University/Spring2017-Applied Data Science/Project_1_Bz2290/Spr2017-Proj1-bz2290/output/Preprocess.R")
###################################################################
```
I. INTRODUCTION

There are two groups of presidential speeches, while the first group is choosen while U.S.is either involved or there is a major tense moment happening in the internaitonal society. While the second group of speeches are choosen during the time when the U.S. economy is booming. We hope to utilize the sentiment ananlysis and other related techniques to see if there are any differneces betweeen those two groups, or if there are any similiarites withiin each group.  

This notebook was prepared with the following environmental settings:
```{r, echo=FALSE}
print(R.version)
```

II.SENTENCE LENGTH

After the data preprocessing(Please refer to "Preprocess.R" for details), we first examine the sentence length of speeches with respect to two groups. What we find first is that from all the speeches I selected, almost all president give a shorter speeches in their second term compared to theris first ones. For example, we observed that from Lincoln's speeches:
```{r, echo=FALSE}
sentence=emotion.matrix[,1:4]
sentence=subset(sentence,as.character(sentence$President) %in% c(speech.selected.war[1],speech.selected.war[2]))
sentence$Pop = factor(sentence$President)
sentence$Ordered=reorder(sentence$Pop,sentence$nword,mean,order=T)
beeswarm(nword~Ordered, 
         data=sentence,
         horizontal = FALSE, 
         pch=1, col="blue",
         cex=0.5, cex.axis=1.1, cex.lab=1.2,
         spacing=5/nlevels(sentence$Ordered),
         las=2,ylab="Number of words",
         xlab="",
         main="Inauguartion speeches")
```
or for Franklin D. Roosevelt:
```{r, echo=FALSE}
par(mfrow=c(1,2))
sentence=emotion.matrix[,1:4]
sentence=subset(sentence,as.character(sentence$President) %in% c(speech.selected.war[5],speech.selected.war[6]))
sentence$Pop = factor(sentence$President)
sentence$Ordered=reorder(sentence$Pop,sentence$nword,mean,order=T)
beeswarm(nword~Ordered, 
         data=sentence,
         horizontal = FALSE, 
         pch=10, col="blue",
         cex=0.3, cex.axis=1.1, cex.lab=1.2,
         spacing=5/nlevels(sentence$Ordered),
         las=2,ylab="Number of words",
         xlab="",
         main="Inauguartion speeches")

sentence=emotion.matrix[,1:4]
sentence=subset(sentence,as.character(sentence$President) %in% c(speech.selected.war[6],speech.selected.war[7]))
sentence$Pop = factor(sentence$President)
sentence$Ordered=reorder(sentence$Pop,sentence$nword,mean,order=T)
beeswarm(nword~Ordered, 
         data=sentence,
         horizontal = FALSE, 
         pch=10, col="blue",
         cex=0.3, cex.axis=1.1, cex.lab=1.2,
         spacing=5/nlevels(sentence$Ordered),
         las=2,ylab="Number of words",
         xlab="",
         main="Inauguartion speeches")
```
We see that from the second to the fourth speeches, the sentences length has decreased from one speech to another.

Despite this pattern, I have also discovered that:
```{r, echo=FALSE}
par(mfrow=c(1,1))
sentence=emotion.matrix[,1:4]
sentence=subset(sentence,as.character(sentence$President) %in% c(speech.selected.war,speech.selected.peace))
sentence$Pop = factor(sentence$President)
sentence$Ordered=reorder(sentence$Pop,sentence$nword,mean,order=T)
beeswarm(nword~Ordered, 
         data=sentence,
         horizontal = FALSE, 
         pch=1, col="blue",
         cex=0.5, cex.axis=1.1, cex.lab=1.2,
         spacing=5/nlevels(sentence$Ordered),
         las=2,ylab="Number of words",
         xlab="",
         main="Inauguartion speeches")
```
All speeches I have choosen have majority of their sentences within 20 words, and there are only a few president who gives extremely long sentences.

II.Sentiment Analysis

(1)Emotion Barplot analytics
After we have examined the length of sentence, we turn our attention to a more interesting asepct of ananlysis - sentiment analysis. I performed the analysis by applied nrc sentimet function to sentences, and calculate a weighted score of emotion "anger", "anticipation", "disgust", "fear", "joy", "sadness", "surprise", "trust", "negative", "positive" at each sentence of each presidential speeches I selected.

First of all, let us take a look at the emotion barplots created for presidential speeches in the "peace" group:
```{r, echo=FALSE}
par(mfrow=c(2,2))
Emotion_Barplot(speech.selected.peace[1])
Emotion_Barplot(speech.selected.peace[2])
Emotion_Barplot(speech.selected.peace[3])
Emotion_Barplot(speech.selected.peace[4])
```
There is no doubt that the top three emotions in each of these four speeches are the same, and the rank of other emotions are not very different. This is no surprise at all, and it is in out expectation. BUt when we take a look at the emtion barplot(partial)for speeches in the war group, we observed an intersting pattern:
```{r, echo=FALSE}
par(mfrow=c(2,2))
Emotion_Barplot(speech.selected.war[1])
Emotion_Barplot(speech.selected.war[3])
Emotion_Barplot(speech.selected.war[6])
Emotion_Barplot(speech.selected.war[8])
```
Surprisingly, positive emotions still makes up the top two emotions in these speeches, and there are only one speeches whose top emtion is not positive, which is the second speech given by Lincoln, towards to the end of the civil war.
```{r, echo=FALSE}
par(mfrow=c(1,1))
Emotion_Barplot(speech.selected.war[2])
```
Compared to Lincoln's first speech, we see that the rank of  negative emotion actually goes up even the civil war is aabout to end, but another president who has a similiar experience, of course, this time, the second world war, has a differnt change of emotions during his speech:
```{r, echo=FALSE}
par(mfrow=c(2,2))
Emotion_Barplot(speech.selected.war[5])
Emotion_Barplot(speech.selected.war[6])
Emotion_Barplot(speech.selected.war[7])
```
We see that the rank of the negative emotion is from one speech to another rather than going up.

For now, we observed that the emotion of presidential speeches during war time is surprisingly positive, in addition, we also have two presidents whose speeches were given thorought out wars have differnet change od emotions.In order to shed lights into these patterns, I decided to utlize some more techniques to derive more insights.

I decided to examine the sentences that carry the emotions of interest to see if I can find more interesting things.First,let us examine the "fear" sentences from Lincoln's first speech:
```{r, echo=FALSE}
Emotion_Sentences(pop=speech.selected.war[1])[4,]
```
Then, the "fear" sentence from the second speech:
```{r, echo=FALSE}
Emotion_Sentences(pop=speech.selected.war[2])[4,]
```
From these two sentences, we see that the "fearest" sentence is the govenrment will not attack viciously on someone or some group of people, while the sentence of interest in the second speech clearly express his wish for the civil war to end. More historical analysis can possibliy dig in the experiecne he had during the war as well as his feelings to better explain this change of fcous on Lincoln's fear sentences throughout the civil war.

Now let us take a look at the fear sentences from FranklinDRoosevelt's speeches:
```{r, echo=FALSE}
Emotion_Sentences(pop=speech.selected.war[5])[4,]
```

```{r, echo=FALSE}
Emotion_Sentences(pop=speech.selected.war[6])[4,]
```

```{r, echo=FALSE}
Emotion_Sentences(pop=speech.selected.war[7])[4,]
```
We see that from the first "fear" setence, Roosevelt is certain that some action should be taken to encounter something that cause fear and suffering. He maybe talking about the big depression, or he maybe talking about the tension among countries in the international communities. The second line shows his determinaiton of puting away "evil things", while the last sentence shows his opportunity of achieveing peace.

The focus of Lincoln's fear has been rather focused, while that of Roosevelt has been chaging from one speech to another.

(2) Cluster Plot analytics
The fact that the speeches from both the war and non-war groups share similar top emotions intrigues me to see whether I can perform a cluster analysis to classify these speeches into different classes base on their emotions. We first take a look at the cluster analysis of war group, and the cluster analysis are based on the emotion scores of each presidential speech and a kmeans cluster algorithm is also deployed.

I first tries two clusters
```{r, echo=FALSE}
km.res=kmeans(presid.summary.war[,-1],2,iter.max=200,nstart=5)
fviz_cluster(km.res, 
             stand=F, repel= TRUE,
             data = presid.summary.war[,-1], xlab="", xaxt="n",
             show.clust.cent=FALSE)
```
We can generally group these speeches into two groups based on whether they are before of after the thrid speeches given be FranklinDRoosevelt. But I feel like put speech four from Roosevelet into cluster one is a bit of a stretch, so I also performed cluster analysis using three clusters.
```{r, echo=FALSE}
km.res=kmeans(presid.summary.war[,-1],3,iter.max=200,nstart=5)
fviz_cluster(km.res, 
             stand=F, repel= TRUE,
             data = presid.summary.war[,-1], xlab="", xaxt="n",
             show.clust.cent=FALSE)
```
The second cluster seems to be better and we see that general emotion from FranklinDRoosevelt speeches changes dramatically, as his three speeches belong to three different clusters seperately.

Similiary, I also performed cluster analysis on the peace group
```{r, echo=FALSE}
km.res=kmeans(presid.summary.peace[,-1],2,iter.max=200,nstart=5)
fviz_cluster(km.res, 
             stand=F, repel= TRUE,
             data = presid.summary.peace[,-1], xlab="", xaxt="n",
             show.clust.cent=FALSE)
```
Which do not reveal many interesting results as the number of speeches selected are not big.

At last, I performed cluster analysis on all of them:
```{r, echo=FALSE}
km.res=kmeans(presid.summary.all[,-1],4,iter.max=200,nstart=5)
fviz_cluster(km.res, 
             stand=F, repel= TRUE,
             data = presid.summary.all[,-1], xlab="", xaxt="n",
             show.clust.cent=FALSE)
```

```{r, echo=FALSE}
km.res=kmeans(presid.summary.all[,-1],3,iter.max=200,nstart=5)
fviz_cluster(km.res, 
             stand=F, repel= TRUE,
             data = presid.summary.all[,-1], xlab="", xaxt="n",
             show.clust.cent=FALSE)
```
From either the analysis using three clusters or the analysis using four clusters, we can see that we are not be able to distinctly distinguish speeches from war time and non war time, as they coexist in both major clusters.This does not come as a surprise since our emotion barplot shows similiar results.

All in all, speeches given during war time or non-war time does have interesting pattern that surprises us, but there  are also similarities among them, regardless of the time period they are given. I hope you enjoy my blog and thank you for reading!


